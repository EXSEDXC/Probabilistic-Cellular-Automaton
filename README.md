# ðŸ§¬ Probabilistic-Cellular-Automaton

**åŸºäºŽæ¦‚çŽ‡å…ƒèƒžè‡ªåŠ¨æœºçš„ç»†èƒžç¾¤ä½“éšæœºç”Ÿç­ä¸Žç¨³æ€ç»Ÿè®¡åˆ†æž**  
Monte Carlo simulation and nonlinear modeling of stochastic cell dynamics

---

## ðŸ“– é¡¹ç›®æ¦‚è¿° | Overview

æœ¬ä»“åº“å¯¹åº”æ¦‚çŽ‡è®ºæœŸä¸­è®ºæ–‡ã€ŠåŸºäºŽæ¦‚çŽ‡å…ƒèƒžè‡ªåŠ¨æœºçš„ç»†èƒžç¾¤ä½“éšæœºç”Ÿç­ä¸Žç¨³æ€ç»Ÿè®¡åˆ†æžã€‹ã€‚  
ç ”ç©¶é€šè¿‡è’™ç‰¹å¡æ´›æ–¹æ³•ä¸Žéžçº¿æ€§å›žå½’å»ºæ¨¡ï¼ŒæŽ¢è®¨äº†ç»†èƒžç¾¤ä½“åœ¨**éšæœºå‡ºç”Ÿâ€“æ­»äº¡æœºåˆ¶**ä¸Ž**æ‹¥æŒ¤æƒ©ç½š**ä¸‹çš„ç»Ÿè®¡ç¨³æ€è§„å¾‹ã€‚

ç ”ç©¶ç›®æ ‡ï¼š
- å»ºç«‹æ¦‚çŽ‡å…ƒèƒžè‡ªåŠ¨æœºæ¨¡åž‹æ¨¡æ‹Ÿç¾¤ä½“æ¼”åŒ–ï¼›
- ç ”ç©¶ä¸åŒå‚æ•°ä¸‹ç³»ç»Ÿç”±ç­ç»æ€å‘ç¨³å®šæ€çš„è½¬å˜æ¡ä»¶ï¼›
- ä½¿ç”¨ PyTorch éžçº¿æ€§å›žå½’ç¥žç»ç½‘ç»œï¼Œæ‹Ÿåˆå¹¶è§£æžå­˜æ´»æ¦‚çŽ‡ä¸Žç¨³æ€å¯†åº¦å…¬å¼ã€‚

---

## ðŸ§© é¡¹ç›®ç»“æž„ | Repository Structure
```
Probabilistic-Cellular-Automaton/
â”‚
â”œâ”€â”€ code/ â† ä¸»ç¨‹åºï¼ˆæ¨¡æ‹Ÿä¸Žæ‹Ÿåˆï¼‰
â”‚ â”œâ”€â”€ ProbCellularAutomaton_Simulation.py
â”‚ â”œâ”€â”€ NonlinearGLM_Fitting.py
â”‚
â”œâ”€â”€ results/ â† ä»£è¡¨æ€§å‚æ•°ç»„å®žéªŒç»“æžœ
â”‚ â”œâ”€â”€ group1/ # ç­ç»æ€
â”‚ â”œâ”€â”€ group2/ # ç¨³æ€ç”Ÿå­˜
â”‚ â”œâ”€â”€ group5/ # é«˜ç¨³æ€
â”‚ â”œâ”€â”€ group9/ # ä¸´ç•Œè¿‡æ¸¡æ€
â”‚ 
â”‚
â”œâ”€â”€ figures/ â† æ‹Ÿåˆç»“æžœå›¾ï¼ˆç¥žç»ç½‘ç»œæ¨¡åž‹ï¼‰
â”‚ â”œâ”€â”€ Figure_density_fit.png
â”‚ â”œâ”€â”€ Figure_survival_fit.png
â”‚ 
â”‚
â”œâ”€â”€ notes/ â† å®žéªŒè®°å½•ä¸Žå‚æ•°æ—¥å¿—
â”‚ â”œâ”€â”€ parameter_tests.md
â”‚ â”œâ”€â”€ run_notes.md
â”‚
â”œâ”€â”€ paper/ â† è®ºæ–‡ä¸Žæ‘˜è¦
â”‚ â””â”€â”€ æ‘˜è¦.md
â”‚
â””â”€â”€ README.md â† å½“å‰æ–‡ä»¶
```

---
## âš™ï¸ çŽ¯å¢ƒä¾èµ– | Environment

æœ¬é¡¹ç›®åŸºäºŽ **Python 3.13** ä¸Ž **PyTorch 2.9.0 (CUDA 12.8)** å¼€å‘ã€‚  
ç¨‹åºä¾èµ–ä»¥ä¸‹ä¸»è¦å¤–éƒ¨åº“ï¼š

| åº“åç§° | ç‰ˆæœ¬ï¼ˆå»ºè®®ï¼‰ | ç”¨é€”è¯´æ˜Ž |
|:--------|:-------------|:----------|
| **torch** | 2.9.0+cu128 | æ·±åº¦å­¦ä¹ æ¡†æž¶ï¼Œç”¨äºŽç¥žç»ç½‘ç»œå›žå½’æ‹Ÿåˆ |
| **torchvision** | â‰¥0.20 | PyTorch ç”Ÿæ€æ”¯æŒï¼ˆå…¼å®¹æ€§ä¾èµ–ï¼‰ |
| **numpy** | â‰¥2.1 | ç§‘å­¦è®¡ç®—ä¸Žæ•°ç»„è¿ç®— |
| **pandas** | â‰¥2.2 | æ•°æ®ç»“æž„ä¸Žè¡¨æ ¼æ“ä½œ |
| **scipy** | â‰¥1.14 | å·ç§¯ã€ä¿¡å·ä¸Žç»Ÿè®¡è®¡ç®— |
| **scikit-learn** | â‰¥1.6 | æ ‡å‡†åŒ–ã€æŒ‡æ ‡è®¡ç®—ä¸Žæ‹Ÿåˆè¯„ä¼° |
| **matplotlib** | â‰¥3.9 | å›¾è¡¨ç»˜åˆ¶ä¸ŽåŠ¨ç”»ç”Ÿæˆ |
| **seaborn** | â‰¥0.13 | ç»Ÿè®¡å¯è§†åŒ–ä¸Žé…è‰²ä¼˜åŒ– |
| **tqdm** | â‰¥4.66 | æ¨¡æ‹Ÿä¸Žè®­ç»ƒè¿›åº¦æ¡æ˜¾ç¤º |

---

### ðŸ§© çŽ¯å¢ƒå®‰è£… | Installation

æŽ¨èåœ¨è™šæ‹ŸçŽ¯å¢ƒä¸­å®‰è£…ä¾èµ–ï¼ˆä¾‹å¦‚ `venv` æˆ– `conda`ï¼‰ï¼š

#### ðŸ§± 1ï¸âƒ£ å®‰è£… PyTorchï¼ˆCUDA 12.8 ç‰ˆæœ¬ï¼‰

è‹¥ä»…ä½¿ç”¨ CPUï¼Œå¯è·³è¿‡æ­¤éƒ¨åˆ†

```
pip3 install torch torchvision --index-url https://download.pytorch.org/whl/cu128
```


#### ðŸ§± 2ï¸âƒ£ å®‰è£…å…¶ä½™ä¾èµ–

```
pip install -r requirements.txt
```



## ðŸš€ è¿è¡Œè¯´æ˜Ž | How to Run

è¿è¡Œä¸»æ¨¡æ‹Ÿç¨‹åºï¼š
```
python code/ProbCellularAutomaton_Simulation.py
```
è¿è¡Œéžçº¿æ€§å›žå½’æ‹Ÿåˆï¼š
```
python code/NonlinearGLM_Fitting.py
```
## âš™ï¸ å‚æ•°è®¾ç½® | Parameter Configuration

æ‰€æœ‰å¯ä¿®æ”¹å‚æ•°é›†ä¸­åœ¨æºç main()éƒ¨åˆ†ï¼Œå¯ç›´æŽ¥åœ¨æ–‡ä»¶ä¸­ç¼–è¾‘ï¼š  


```python
ProbCellularAutomaton_Simulation.py

# ---------- å‚æ•°ï¼ˆå¦‚éœ€è°ƒæ•´è¯·åœ¨è¿™é‡Œæ”¹ï¼‰ ----------
N_GRID = 100              # ç½‘æ ¼è¾¹é•¿ï¼ˆç³»ç»Ÿè§„æ¨¡ä¸º N_GRID Ã— N_GRIDï¼‰
R_RUNS = 200              # æ¯ç»„å‚æ•°é‡å¤éšæœºæ¨¡æ‹Ÿæ¬¡æ•°
T_MAX_STEPS = 100         # æ¯æ¬¡æ¨¡æ‹Ÿçš„æœ€å¤§æ—¶é—´æ­¥æ•°

P_BIRTH = 0.7             # å•ä½å‡ºç”Ÿæ¦‚çŽ‡
P_DEATH_BASE = 0.3        # åŸºç¡€æ­»äº¡æ¦‚çŽ‡
ALPHA = 2.0               # æ‹¥æŒ¤æƒ©ç½šå¼ºåº¦ç³»æ•°ï¼ˆè¶Šå¤§æƒ©ç½šè¶Šå¼ºï¼‰
N_BIRTH_MAX = 6           # å…è®¸ç¹æ®–çš„æœ€å¤§é‚»åŸŸå†…ä¸ªä½“æ•°
N_DEATH_MIN = 3           # é‚»åŸŸå†…è§¦å‘æ‹¥æŒ¤æƒ©ç½šçš„æœ€å°ä¸ªä½“æ•°

FORCE_RERUN = True        # æ˜¯å¦å¼ºåˆ¶é‡æ–°è¿è¡Œï¼ˆTrue ä¼šè¦†ç›–å·²æœ‰ CSVï¼‰
```
```python
NonlinearGLM_Fitting.py

# ==============================================================
# ðŸ§© ç”¨æˆ·è‡ªå®šä¹‰é…ç½®åŒº â€”â€” ç›´æŽ¥åœ¨æ­¤ä¿®æ”¹
# ==============================================================

USE_GPU = True             # æ˜¯å¦ä½¿ç”¨ GPUï¼ˆå¦‚æžœå¯ç”¨ï¼‰
EPOCHS = 400               # è®­ç»ƒè½®æ•°ï¼ˆç”¨äºŽç¥žç»ç½‘ç»œæ‹Ÿåˆï¼‰
LEARNING_RATE = 1e-2       # å­¦ä¹ çŽ‡
BATCH_SIZE = 32            # æ‰¹å¤§å°ï¼ˆä¸€æ¬¡è®­ç»ƒè¯»å–çš„æ•°æ®é‡ï¼‰
RESULTS_ROOT = "./results" # è¾“å‡ºç»“æžœæ–‡ä»¶å¤¹è·¯å¾„

# äºŒé€‰ä¸€ï¼ˆåªéœ€ä¿®æ”¹ä¸€ä¸ªï¼‰
TOP_K = 13                 # ä¿ç•™å‰ K ä¸ªé‡è¦ç‰¹å¾ï¼ˆè®¾ä¸º None ç¦ç”¨ï¼‰
THRESHOLD = None           # æŒ‰é‡è¦æ€§æ¯”ä¾‹ç­›é€‰ç‰¹å¾ï¼ˆå¦‚ 0.15ï¼ŒNone ç¦ç”¨ï¼‰

# ==============================================================
```
ä¿®æ”¹åŽï¼ŒProbCellularAutomaton_Simulation.pyä¼šæ ¹æ®æ–°å‚æ•°è¿›è¡Œæ¨¡æ‹Ÿå¹¶ç»˜å›¾ï¼Œå¹¶åœ¨æ ¹ç›®å½•ä¿å­˜è¾“å‡ºçš„å„ä¸ªæ–‡ä»¶ï¼Œè‹¥æƒ³é€šè¿‡NonlinearGLM_Fitting.pyè¿›è¡Œæ‹Ÿåˆï¼Œè¯·å°†å„ç»„ä¿¡æ¯ä»¥
```
æ ¹ç›®å½•/results
â”‚ â”œâ”€â”€ group1/ 
â”‚ â”œâ”€â”€ group2/ 
â”‚ â”œâ”€â”€ group3/ 
â”‚ â”œâ”€â”€ groupn/ 
```
çš„å½¢å¼è¿›è¡Œæ•´ç†å­˜å‚¨ï¼Œå¹¶åœ¨groupnä¸‹æ”¾ç½®è®°å½•è¶…å‚æ•°çš„params.json

```json
params.json

{
  "P_birth": 0.7,
  "P_death_base": 0.3,
  "alpha": 4.0,
  "N_birth_max": 3,
  "N_death_min": 5,
  "T_MAX_STEPS":200,
  "note": "p=0.95å‘ç”Ÿåå¸¸è¡Œä¸ºï¼Œæ”¶æ•›å€¼é™ä½Žï¼ŒæŽ¨æµ‹æ˜¯åˆå§‹é«˜å¯†åº¦æƒ©ç½šæ¦‚çŽ‡å¯¼è‡´ç³»ç»Ÿè¿›å…¥ç­ç»æ€"
}

```
æ³¨:noteä»…ä¾›è‡ªè¡Œæ ‡æ³¨ä½¿ç”¨ï¼Œå¯å¿½ç•¥
ç¨‹åºå°†ä¼šè¿›è¡Œæ‹Ÿåˆå¹¶å°†éžçº¿æ€§æ‹Ÿåˆæ¨¡åž‹ç»“æžœæ±‡æ€»ä¸º`fit_formula_summary.md`å¹¶å‚¨å­˜åœ¨æ ¹ç›®å½•

## ðŸ“Š æ¨¡æ‹Ÿç»“æžœ | Representative Results

æœ¬ç ”ç©¶é€‰æ‹©äº†å››ç»„å…¸åž‹å‚æ•°ç»„ï¼ˆå…± 13 ç»„ä¸­çš„ä»£è¡¨æ€§æ ·æœ¬ï¼‰ä»¥å±•ç¤ºç³»ç»Ÿç›¸å˜ç‰¹å¾ï¼š

| Group       | æè¿°    | å‚æ•°ç®€è¿°                          | ç¨³æ€è¡Œä¸º            |
| :---------- | :---- | :---------------------------- | :-------------- |
| **Group 1** | ç­ç»æ€   | P_birth=0.4, P_death=0.6, Î±=4 | å¯†åº¦è¿…é€Ÿè¡°å‡è‡³é›¶        |
| **Group 2** | ç¨³æ€ç”Ÿå­˜  | P_birth=0.7, P_death=0.3, Î±=4 | ç¨³å®šä¸­ç­‰å¯†åº¦ (~0.4)   |
| **Group 5** | é«˜ç¨³æ€   | P_birth=0.5, P_death=0.5, Î±=0 | é«˜å¯†åº¦ç¨³å®šç”Ÿå­˜ (~0.76) |
| **Group 9** | ä¸´ç•Œè¿‡æ¸¡æ€ | P_birth=0.6, P_death=0.4, Î±=2 | ä½Žå¯†åº¦ç¨³æ€ (~0.24)   |

å®Œæ•´ç»“æžœï¼ˆ13 ç»„ï¼Œçº¦ 1.2GBï¼‰æ— æ³•ä¸Šä¼ ï¼Œå¯ç§ä¿¡ä½œè€…æä¾›ã€‚
## ðŸ“ˆ æ¨¡åž‹æ‹Ÿåˆç»“æžœ | Model Fitting Results

åˆ©ç”¨ PyTorch å®žçŽ°çš„æ˜¾å¼éžçº¿æ€§å›žå½’ç¥žç»ç½‘ç»œï¼Œå¯¹æ¨¡æ‹Ÿæ ·æœ¬çš„ç»Ÿè®¡ç»“æžœè¿›è¡Œå¤šå‚æ•°æ‹Ÿåˆã€‚
ä¸‹å›¾å±•ç¤ºæ¨¡åž‹åœ¨ç¨³æ€å¯†åº¦ä¸Žå­˜æ´»æ¦‚çŽ‡é¢„æµ‹ä¸Šçš„æ‹Ÿåˆæ•ˆæžœï¼š

![ç¨³æ€å¯†åº¦é¢„æµ‹](figures/Figure_density_fit.png)
![å­˜æ´»æ¦‚çŽ‡é¢„æµ‹](figures/Figure_survival_fit.png)

**æ¨¡åž‹æ€§èƒ½:**
- éªŒè¯é›† RÂ² (Survival): 0.9888
- éªŒè¯é›† RÂ² (Density): 0.9959
- éªŒè¯é›† MSE (Survival): 0.002279
- éªŒè¯é›† MSE (Density): 0.000301

## ðŸ§® å®žéªŒå‚æ•°è®°å½• | Notes

13ç»„å®žéªŒè¿è¡Œå‚æ•°å·²æ•´ç†äºŽ /notes/ æ–‡ä»¶å¤¹ä¸­ï¼Œé¢„è®¡å¯ä»¥å¤çŽ°ç»“æžœ

## ðŸ“˜ è®ºæ–‡ä¸Žæ‘˜è¦ | Paper

æ‘˜è¦æ–‡ä»¶å­˜æ”¾äºŽï¼š
```
/paper/
â””â”€â”€ æ‘˜è¦.md
```
å®Œæ•´è®ºæ–‡æš‚ä¸åœ¨æ­¤æä¾›ï¼Œå¯ç§ä¿¡ä½œè€…

## ðŸ§  è‡´è°¢ | Acknowledgments

æœ¬ç ”ç©¶ç»“åˆäº†æ¦‚çŽ‡è®ºã€æ•°ç†ç»Ÿè®¡ä¸Žè®¡ç®—æ¨¡æ‹Ÿæ–¹æ³•ï¼Œç”¨äºŽåˆ»ç”»éšæœºç³»ç»Ÿåœ¨ç”Ÿç­æœºåˆ¶ä¸‹çš„ç¨³æ€è¡Œä¸ºä¸Žç›¸å˜è§„å¾‹ã€‚

æ„Ÿè°¢æœ¬äººå®¤å‹[@meteor-shower-l](https://github.com/meteor-shower-l)æä¾›çš„çµæ„Ÿæ¥æº

æ„Ÿè°¢Geminiæä¾›çš„å®žçŽ°æ€è·¯

æ„Ÿè°¢ChatGPTæä¾›çš„æŠ€æœ¯æŒ‡å¯¼

æ„Ÿè°¢è±†åŒ…æä¾›çš„å¤æ‚LateXå…¬å¼æ ¡æ­£

æ„Ÿè°¢è…¾è®¯å…ƒå®æä¾›çš„å®¡æŸ¥ä¸Žä¿®æ”¹å»ºè®®

## ðŸ“š æœ€åŽ

æœ¬é¡¹ç›®ä»¥æ¦‚çŽ‡è®ºä¸Žæ•°ç†ç»Ÿè®¡ä¸ºç†è®ºåŸºç¡€ï¼Œç»“åˆè’™ç‰¹å¡æ´›æ¨¡æ‹Ÿä¸Žç¥žç»ç½‘ç»œå»ºæ¨¡ï¼Œ  
æ—¨åœ¨åˆ»ç”»å¤æ‚éšæœºç³»ç»Ÿçš„ç¨³æ€è¡Œä¸ºä¸Žç›¸å˜è§„å¾‹ã€‚  
é¡¹ç›®å…¨éƒ¨ä»£ç ã€æ•°æ®ä¸Žç»“æžœå‡å¯å¤çŽ°ï¼Œæ¬¢è¿Žå‚è€ƒæˆ–æ”¹è¿›ã€‚

---

Â© 2025 ä½œè€…ï¼š[EXSEDXC](https://github.com/EXSEDXC)  
ä»…ä¾›å­¦æœ¯ç ”ç©¶ä¸Žæ•™å­¦ç”¨é€”ã€‚

---


## ðŸ§  æœªæ¥å·¥ä½œä¸Žåé¦ˆ


æœ¬é¡¹ç›®ä»å¤„äºŽæŽ¢ç´¢é˜¶æ®µï¼Œä¸»è¦é¢å‘è¯¾ç¨‹ç ”ç©¶ä¸Žå­¦ç”Ÿç§‘ç ”è®­ç»ƒã€‚  
æœªæ¥å°†å°è¯•ä»¥ä¸‹æ”¹è¿›æ–¹å‘ï¼š  
- å¼•å…¥æ›´å¤šç©ºé—´å¼‚è´¨æ€§ä¸Žé‚»åŸŸç»“æž„å˜åŒ–ï¼›  
- ä¼˜åŒ–è’™ç‰¹å¡æ´›é‡‡æ ·ç­–ç•¥ï¼Œæé«˜æ”¶æ•›é€Ÿåº¦ï¼›  
- è¿›ä¸€æ­¥åˆ†æžç¥žç»ç½‘ç»œæ‹Ÿåˆçš„ç¨³å®šæ€§ä¸Žæ³›åŒ–è¯¯å·®ã€‚

å¦‚æžœä½ æ˜¯ä¸€åæ¥è‡ªäººå·¥æ™ºèƒ½ã€è®¡ç®—æœºã€è‡ªåŠ¨åŒ–æˆ–ç›¸å…³å·¥ç§‘ä¸“ä¸šçš„å­¦ç”Ÿï¼Œ  
å¸Œæœ›è¿›è¡Œç®—æ³•å®žçŽ°ã€æ•°å€¼å®žéªŒç­‰æ–¹é¢çš„æŠ€æœ¯äº¤æµï¼Œ  
æˆ–åªæ˜¯æƒ³ä¸€èµ·è®¨è®ºæ¨¡åž‹æ€è·¯ï¼Œä¹Ÿéžå¸¸æ¬¢è¿Ž ðŸ˜„ã€‚  

ä½ å¯ä»¥é€šè¿‡ [Discussions] æˆ– [Issues]è¿›è¡Œäº¤æµã€æå‡ºå»ºè®®ã€å¤çŽ°å®žéªŒæˆ–åˆ†äº«ç»“æžœã€‚  
æœ¬äººæ°´å¹³æœ‰é™ï¼Œä½†ååˆ†ä¹æ„ä¸Žå¤§å®¶å…±åŒæŽ¢è®¨ ðŸ¤ã€‚  
ä»»ä½•å»ºè®¾æ€§çš„åé¦ˆéƒ½å°†è¢«è®¤çœŸè®°å½•å¹¶æ„Ÿè°¢ã€‚ ðŸ˜Š


## ðŸ“„ License

This project is licensed under the **Apache License 2.0**.  
You may use, distribute, and modify this project under the terms of the license,  
provided that proper credit is given to the original author and that the license notice is included in all copies or derivative works.

> Â© 2025 [EXSEDXC](https://github.com/EXSEDXC)  
> Licensed under the Apache License, Version 2.0 (the "License");  
> you may not use this file except in compliance with the License.  
> You may obtain a copy of the License at:  
> [http://www.apache.org/licenses/LICENSE-2.0](http://www.apache.org/licenses/LICENSE-2.0)

Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an "AS IS" BASIS,  
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.  
See the License for the specific language governing permissions and limitations under the License.